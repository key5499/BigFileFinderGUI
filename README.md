# DiskSpaceAnalyzer

一个功能强大的磁盘空间分析工具，帮助您快速找出占用大量磁盘空间的文件和文件夹，方便进行磁盘清理和空间管理。
![截图](https://github.com/key5499/BigFileFinderGUI/blob/main/QQ20251216-101641.png)

## ✨ 功能特性

### 🔍 扫描功能
- 支持扫描整个磁盘或特定文件夹
- 可选择扫描文件、文件夹或两者
- 实时显示扫描进度和当前扫描位置
- 支持扫描过程中暂停和停止

### 📊 数据分析
- 按大小排序显示扫描结果
- 清晰区分文件和文件夹
- 显示文件/文件夹大小、路径和百分比
- 直观的条形图显示大小比例
- 支持按不同列排序

### 💾 导出功能
- 支持将扫描结果导出到Excel文件
- 兼容多种Excel库（openpyxl、xlsxwriter）
- 导出包含完整的扫描信息

### 🎨 用户界面
- 现代化的深色主题设计
- 左右分栏布局，左侧文件夹树，右侧大小列表
- 支持Ctrl和Shift键多选行
- 便捷的右键菜单操作

### 🗑️ 文件管理
- 支持将选中的文件/文件夹删除到回收站
- 删除前确认提示，防止误操作
- 显示详细的删除结果

## 🚀 快速开始

### 系统要求
- Windows操作系统
- Python 3.7+
- PySide6
- psutil

### 安装步骤

1. **克隆或下载项目**
   ```bash
   git clone https://github.com/yourusername/DiskSpaceAnalyzer.git
   cd DiskSpaceAnalyzer
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **运行应用**
   ```bash
   python Find.py
   ```

## 📖 使用指南

### 1. 选择扫描目标
- **磁盘选择**：从顶部下拉菜单选择要扫描的磁盘
- **文件夹选择**：在左侧树形视图中选择特定文件夹

### 2. 设置扫描方式
- 勾选"文件"：扫描单个文件
- 勾选"文件夹"：扫描文件夹大小
- 可同时勾选两者，扫描所有内容

### 3. 开始扫描
- 点击"🔍 开始扫描"按钮
- 观察顶部进度条和状态栏了解扫描进度
- 扫描过程中可点击"⏹️ 停止扫描"暂停

### 4. 查看扫描结果
- 扫描结果将显示在右侧表格中
- 按大小自动排序，最大的项目显示在最上方
- 可点击列标题切换排序方式
- 文件和文件夹通过不同样式区分（文件夹名称加粗）

### 5. 导出结果
- 扫描完成后，点击"📤 导出列表"按钮
- 选择保存位置和文件名
- 导出的Excel文件包含完整的扫描信息

### 6. 管理文件
- 按住Ctrl键点击行进行多选
- 按住Shift键选择连续多行
- 右键点击选中的行，选择"🗑️ 删除选中"将其删除到回收站

## 📁 项目结构

```
DiskSpaceAnalyzer/
├── Find.py              # 主程序文件
├── requirements.txt      # 依赖列表
└── README.md            # 项目文档
```

## 🛠️ 技术实现

### 核心技术栈
- **GUI框架**：PySide6
- **多线程**：使用QThread实现扫描线程
- **磁盘操作**：使用psutil和os模块
- **Excel导出**：支持openpyxl和xlsxwriter

### 主要类和功能

| 类名 | 功能描述 |
|------|----------|
| `FolderSizeScanner` | 扫描线程类，负责扫描磁盘空间 |
| `ItemSizeModel` | 自定义表格模型，显示扫描结果 |
| `SizeBarDelegate` | 自定义委托，绘制大小条形图 |
| `DarkDiskSpaceAnalyzer` | 主窗口类，管理UI和业务逻辑 |

## 🔧 自定义配置

### 修改主题
- 可在`set_dark_theme`方法中修改CSS样式
- 支持调整颜色、字体和布局

### 修改扫描参数
- 在`run`方法中可调整最大扫描文件夹数量
- 在`_get_folder_size`方法中可调整扫描逻辑

## 📝 许可证

MIT License

## 🤝 贡献

欢迎提交Issue和Pull Request！

## 📞 联系方式

如有问题或建议，欢迎通过GitHub Issues反馈。

---

**享受高效的磁盘空间管理体验！** 🎉
